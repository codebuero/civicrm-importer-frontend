# CiviCRM Entity Importer

# Create + Update Steps after Fileupload

1. Calculate Prefixes from Gender + Title
2. Retrieve Prefixes, check for up-to-dateness, update if neccessary (w/o deleting)

3. Retrieve Contact, check if external_identifiers in file are already
   in database

   3.a if yes, check for diff between file and civi and update if neccessary
   3.b if no, proceed

4. Check unfound entities in file for validity

   4.a if invalid/incomplete entries are found, mark and send to user
   4.b if all entries are valid, proceed

5. Create new contacts

   5.a look up prefix id
   5.b set contact type
   5.c set prefered communication style









    contact_type = Individual
    contact_sub_type = NULL
    do_not_email = 0
    do_not_phone = 0
    do_not_mail  = 0
    do_not_sms   = 1
    do_not_trade = 1
    is_opt_out = 0
    legal_identifier = NULL
    external_identifier = ID in Excelliste
    organization_name = Name der Organisation, wenn Feld vorhanden. Organisation muss vorher oder danach mit contact_type=organisation angelegt werden
    preferred_language = !!!! Sprache eventuell aus Liste entnehmen o. Land o. PLZ
    street_address = straße und hausnummer
    city = stadt
    postal_code = PLZ
    country_id = 1082 für Dtl., andere auflösen über
    http://localhost:8081/sites/all/modules/civicrm/extern/rest.php?entity=country&action=get&json=1&key=4276a76c2f8e0dd666e06ec3f1a80259&api_key=kreis

    emails: 1. wird automatisch als Home Email eingefügt, alle weiteren nur nachträglich einfügbar
    location_type_ids hier
    http://localhost:8081/sites/all/modules/civicrm/extern/rest.php?entity=location_type&action=get&json=1&key=4276a76c2f8e0dd666e06ec3f1a80259&api_key=kreis

    email anlegen:
    http://localhost:8081/sites/all/modules/civicrm/extern/rest.php?entity=email&action=create&json=1&key=4276a76c2f8e0dd666e06ec3f1a80259&api_key=kreis&contact_id=6&location_type_id=2&email=hello@goodbye.de&primary=0

    http://localhost:8081/sites/all/modules/civicrm/extern/rest.php?entity=email&action=create&json=1&key=4276a76c2f8e0dd666e06ec3f1a80259&api_key=kreis&contact_id=6&location_type_id=1&email=hello@hello.de&primary=0
